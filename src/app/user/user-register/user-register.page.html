<div class="user-organization-toggle-wrapper">
  <label [ngClass]="userChecked ? 'checked-toggle' : ''">Потребител</label>
  <ion-toggle (ionChange)="userChecked = !userChecked"></ion-toggle>
  <label [ngClass]="!userChecked ? 'checked-toggle' : ''">Организатор</label>
</div>

<ng-container *ngIf="userChecked">
  <form #registerForm="ngForm" (submit)="onRegister(registerForm)">
    <div class="auth-wrapper">

      <!-- email -->
      <div class="auth-input">
        <ion-input type="email" fill="solid" label="Имейл*" labelPlacement="floating" name="email" ngModel
          #email="ngModel" clearInput required pattern="^[a-zA-Z0-9\._+\-]+@[a-zA-Z0-9\.]+\.[a-zA-Z]{2,}$"></ion-input>
      </div>

      <ng-container *ngIf="email.touched">
        <p class="auth-validation-error-message" *ngIf="email.errors?.['required']">
          Полето е задължително за попълване!
        </p>
        <p class="auth-validation-error-message" *ngIf="email.errors?.['pattern']">
          Моля въведете валиден имейл!
        </p>

        <!-- TODO: When server returns email already taken -->
        <!-- <p class="auth-validation-error-message" *ngIf="emailError">
          Този имейл вече е използван!
        </p> -->
      </ng-container>

      <!-- password -->
      <div class="auth-input">
        <ion-input type="password" fill="solid" label="Парола*" labelPlacement="floating" name="password" ngModel
          #password="ngModel" required minlength="8" clearInput
          pattern="^(?=.*\d)(?=.*[a-z])(?=.*[A-Z])(?!\s).+$"></ion-input>
      </div>

      <ng-container *ngIf="password.touched">
        <p class="auth-validation-error-message" *ngIf="password.errors?.['required']">
          Полето е задължително за попълване!
        </p>
        <p class="auth-validation-error-message" *ngIf="password.errors?.['minlength']">
          Паролата трябва да е с дължина поне 8 символа!
        </p>
        <p class="auth-validation-error-message" *ngIf="password.value && !password.value.match('\\d')">
          Изисква се поне една цифра в паролата!
        </p>
        <p class="auth-validation-error-message" *ngIf="password.value && !password.value.match('[a-z]')">
          Паролата трябва да съдържа поне 1 малка буква!
        </p>
        <p class="auth-validation-error-message" *ngIf="password.value && !password.value.match('[A-Z]')">
          Паролата трябва да съдържа поне 1 голяма буква!
        </p>
        <p class="auth-validation-error-message" *ngIf="password.value && password.value.includes(' ')">
          Паролата не трябва да съдържа празни места!
        </p>

        <!-- TODO: When server returns email already taken -->
        <!-- <p class="auth-validation-error-message" *ngIf="passwordError">
          Грешна парола!
        </p> -->
      </ng-container>

      <div class="auth-input">
        <ion-input type="password" fill="solid" label="Повтори парола*" labelPlacement="floating" name="repeatPassword"
          ngModel #repeatPassword="ngModel" required clearInput pattern="{{ password.value }}"></ion-input>
      </div>

      <!-- repeat password -->
      <ng-container *ngIf="repeatPassword.touched">
        <p class="auth-validation-error-message" *ngIf="repeatPassword.errors?.['required']">
          Полето е задължително за попълване!
        </p>
        <p class="auth-validation-error-message" *ngIf="repeatPassword.errors?.['pattern']">
          Моля уверете се, че паролите съвпадат!
        </p>
      </ng-container>

      <!-- first name -->
      <div class="auth-input">
        <ion-input type="text" fill="solid" label="Име" labelPlacement="floating" clearInput
          name="firstName"></ion-input>
      </div>

      <!-- last name -->
      <div class="auth-input">
        <ion-input type="text" fill="solid" label="Фамилия" labelPlacement="floating" name="lastName"
          clearInput></ion-input>
      </div>

      <div class="auth-input">
        <ion-select interface="popover" placeholder="Населено място" class="region-select" slot="end" name="region">
          <ion-select-option value="{{region}}" *ngFor="let region of bulgarianRegions">{{region}}</ion-select-option>
        </ion-select>
      </div>

    </div>

    <div class="main-button-wrapper">
      <button class="main-button">Регистрация</button>
    </div>
  </form>
</ng-container>
<ng-container *ngIf="!userChecked">
  <app-organization-register></app-organization-register>
</ng-container>